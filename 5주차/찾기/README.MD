# 문제: [찾기][link]

[link]: https://www.acmicpc.net/problem/1786

### 출제자 : 최은우

---
### 풀이법 : 

## 1. KMP 기본

kmp 문자열 알고리즘을 사용해야하는 문제
kmp 알고리즘은 두가지 단계로 나뉘게 되는데

1. 찾고자 하는 문자열의 접두사 테이블을 생성
2. 전체 문자열에서 접두사 테이블을 사용하여 문자열 찾기


aaaaaaaaaab 라는 문자열로부터 aaaab 라는 문자열을 찾는다고 가정을 하자

## 2. 일반적인 문자열 찾기

일반적인 문자열 찾기 알고리즘을 생각해보았을 때 

인덱스 0 의 a에서 aaaaa 까지 비교하고 아님을 확인  
인덱스 1 의 b에서 aaaaa 까지 비교하고 아님을 확인  
인덱스 2 의 a에서 aaaaa 까지 비교하고 아님을 확인  
. . .   
인덱스 6 의 a에서 aaaaa 까지 비교하고 맞음을 확인  

을 거치게 된다.

길이가 n인 문자열에서 길이가 k인 문자열을 찾는다고 하였을 때  
최대 n*k 만큼의 비교를 해야한다는 것이다.

해당 문제는 n 과 k 가 100만씩이니 10^12 승인 문자열 비교는 시간초과가 나게된다  
따라서 해당 방법은 사용하질 못한다

## 3. KMP 사용

kmp는 기본적으로 이미 검색해서 결과를 알고있는데 왜 다시 찾아야하지? 라는 물음에서 시작되었기때문에  
위의 예제에서 0번째 인덱스에서 aaaaa를 찾았다면 찾아야할 aaaa는 이미 1번째 인덱스에서부터 존재한다는걸 기억한다는 의미이다.

한마디로 **찾아야 하는 문자열이 내부적으로 반복이 된다면 그만큼 시간을 단축시킬 수 있다.**  라는 의미가 된다.  
거기에 찾아야 하는 문자열이 전부 다 일치하여야 하니 문자열이 맨 처음부터 같아야 한다는 의미이고 이는 곧 접두사를 찾아야 하는 말이된다.

해당 테이블은 다음과 같은 모습을 하게 된다.

|인덱스 | 0 | 1 | 2 | 3 | 5 | 6 | 7 | 8 |
|------ |---|---|---|---|---|---|---|---|
|문자열 | a | a | b | a | b | a | a | a |
|접두사 | 0 | 1 | 0 | 1 | 0 | 1 | 2 | 2 |


aabaabaaa는 찾아야하는 문자열이다.  
만약 이 문자열이 어떤 문장에서 7번째 인덱스까지 일치하고 8번째 인덱스에서 a 가 아닌 다른 값이 나왔다면
5번째 인덱스까지는 스킵을 하고 찾아도 된다라는 알고리즘인 것이다.

## 4. KMP 사용 예시

예시를 가지고 한번 보자

``````
전체 문자열 n  = aababaababaaaa
찾고자 하는 문자열 k  = aababaaa  
``````

k의 접두사 테이블

|인덱스 | 0 | 1 | 2 | 3 | 5 | 6 | 7 | 8 |
|------ |---|---|---|---|---|---|---|---|
|문자열 | a | a | b | a | b | a | a | a |
|접두사 | 0 | 1 | 0 | 1 | 0 | 1 | 2 | 2 |


n과 k 의 비교

|인덱스 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 10 | 11 | 12 | 13 | 14 |
|------ |---|---|---|---|---|---|---|---|---|--- | ---| ---| ---| ---|
|   n   | a | a | b | a | b | a | a | b | a | b  |  a |  a |  a |  a |
|   k   | a | a | b | a | b | a | a | a |   |    |    |    |    |    |
|틀린곳 |   |   |   |   |   |   |   | V |   |    |    |    |    |    |

7번 인덱스에서 틀렸으니 접두사 테이블은 2번까지가 일치함을 알수있음  
따라서 다음 비교는 1번 인덱스에서 시작하는게 아닌 틀린곳에서부터  
일치하는 인덱스를 뺀곳부터 시작한다


|인덱스 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 
|------ |---|---|---|---|---|---|---|---|---|---|--- | ---| ---| ---| ---| 
|   n   | a | a | b | a | b | a | a | b | a | b |  a |  a |  a |  a |  a |
|   k   |   |   |   |   |   | a | a | b | a | b |  a |  a |  a |    |    | 
|시작점 |   |   |   |   |   | V |   |   |   |   |    |    |    |    |    | 

이렇게 비교를 하면 알고리즘의 속도는 n+k 로 축소시킬수 있고  
이게 kmp알고리즘 이다