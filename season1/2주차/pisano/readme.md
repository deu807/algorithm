# 문제: [피사노 주기][link]

[link]: https://www.acmicpc.net/problem/9471

### 출제자 : 최은우

---
### 풀이법 : 

## 1. 피사노 주기란?

 피보나치 수열을 특정값 n 으로 나눈 나머지는 항상 수열을 이룬다

## 2. 간단 확인
피보나치 수열은 n 20까지 나열하면 다음과 같다
> fn = 0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765

여기서 각 n을 넣어 나머지 값을 나열해 본다

```
fn    | 0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765
n = 2 | 0 1 1 0 1 1 0  1  1  0  1  1   0   1   1   0   1    1    0    1    1
n = 3 | 0 1 1 2 0 2 2  1  0  1  1  2   0   2   2   1   0    1    1    2    0
n = 4 | 0 1 1 2 3 1 0  1  1  2  3  1   0   1   1   2   3    1    0    1    1
.     |
.     |
.     |
n = 11| 0 1 1 2 3 5 8  2 10  1  0  1   1   2   3   5   8    2   10    1    0  
```

n이 2 일때는 011 을 반복하는 3자리 수열  

n이 3 일때는 01120221 을 반복하는 8자리 수열

n이 4 일때는 0112310  을 반복하는 6자리 수열
n이 11 일때는 01123582101 을 반복하는 10자리 수열을 보인다

이렇게 n에 숫자가 주어지면 반복하는 수열이 몇 주기인지찾는게 이 문제의 목표가 되겠다.

## 3. 피보나치 수열을 돌리면서 확인을 하는 방법?

각 피보나치 수열을 구하면서 n을 나누는 방법을 먼저 생각해 볼수가 있다.
나눴을때 0이 나온 숫자를 기준으로 확인하는 코드를 짜야하는데

n = 3일때를 먼저 예를 들어보자, 

인덱스가 4번째까지 오면
str = 0112
라는 문자열을 얻게되고 다음 숫자인 0이 나왔을때부터 str과 비교를 해야한다
```
compare = 0
repeat  = 0

compare = 01
repeat  = 1

compare = 011
repeat  = 1

compare = 0112
repeat  = 2

compare = 01120
repeat  = 0

compare = 011202
repeat  = 02

compare = 0112022
repeat  = 2

compare = 01120221
repeat  = 1

compare = 011202210
repeat  = 0

compare = 0112022101
repeat  = 01


compare = 01120221011
repeat  = 011
.
.
.

compare = 0112022101120221
repeat  = 01120221
```

이렇게 비교하는 코드를 작성해야하는데 테스트 케이스가 1천개에 최대 숫자가 백만인 상태에서

매 입력마다 문자열 비교를 하게되었을때 무조건 시간초과가 뜬다

그러므로 해당 방법으로는 풀지 못한다.

## 4. 나머지 규칙을 사용한다.


이 문제는 기본적으로 피보나치 수열을 따르고 있다.

fn 의 어떤값이 x이고 fn+1 이 y 일때 fn+2 는 x+y라는 값을 가진다는걸 기억하고 우리는 이 값을 z라고 두자

구해야하는 주기의 값을 a라고 했을 때 
> z mod a = (x mod a + y mod a) mod a

이런 규칙을 세울 수 있는데 간단하게 확인을 하면

```
a = 4
x = 14
y = 15
일 때

z = 29 이고 

x mod a = 14 mod 4 = 2
y mod a = 15 mod 4 = 3

z mod a = 29 mod 4 = 1
        = (14 mod 4 + 15 mod 4) mode 4
        = (2 + 3) mod 4
        = 5 mod 4
        = 1
```
이렇게 간단히 위의 식이 문제가 없다는걸 확인할 수 있다.

피사노의 주기는 어떠한 경우의 수가 오더라도 0 1 을 시작으로 한다.
따라서 그 다음 숫자의 경우는 무조건 
> (0+1) mod n

을 가지게 될 것이며 그 다음 수는
> (1 + (0+1) mod n) mod n

이 된다

주기를 구하고자 하는 수 x는
```
fn   mod x = 0
fn+1 mod x = 1
```

의 경우를 찾으면 맨 처음 수열을 그대로 재현 할 수 있게 된다는 의미이다.


## 5. 결론

이 문제는 O(N) 이하 의 문제로 피보나치 수열을 구하며 n을 나눈 나머지를 구하면서 나머지가 0과 1이 연속으로 나오는 값만 찾으면 풀리는 문제이다